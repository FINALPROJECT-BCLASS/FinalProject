<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="chatMapper">
	
	<resultMap type="Member" id="memberResultSet">
		<id property="id" column="ID"/>
		<result property="name" column="NAME"/>
		<result property="nickname" column="NICKNAME"/>
		<result property="email" column="EMAIL"/>
		<result property="phone" column="PHONE"/>
		<result property="birthday" column="BIRTHDAY"/>
		<result property="address" column="ADDRESS"/>
		<result property="main_no" column="MAIN_NO"/>
		<result property="original_file" column="ORIGINAL_FILE"/>
		<result property="rename_file" column="RENAME_FILE"/>
		<result property="out_yn" column="OUT_YN"/>
		
	</resultMap>
	
	<resultMap type="Chat" id="chatResultSet">
		<id property="id" column="ID"/>
		<result property="id2" column="ID2"/>
		<result property="co_no" column="CO_NO"/>
		<result property="ol_no" column="OL_NO"/>
		<result property="ol_cont" column="OL_CONT"/>
		<result property="ol_date" column="OL_DATE"/>
		
	</resultMap>

<select id="selectMember" parameterType="string" resultMap="memberResultSet">

	SELECT *
	FROM MEMBER
	WHERE NAME = #{name}
	
</select>



<insert id="insertFriendList" parameterType="hashmap">
	INSERT INTO FRIEND_LIST
	VALUES(SEQ_FL.NEXTVAL
			,#{Id}
			,#{friend_id}
			,DEFAULT)
</insert>

<select id="selectFriend" resultType="string" resultMap="memberResultSet">
	SELECT M.*
	FROM FRIEND_LIST FL
	JOIN MEMBER M ON (FL.FL_ID = M.ID)
	WHERE FL.ID= #{Id}
</select>

<select id="selectChatOnetoOne" resultType="hashmap" resultMap="chatResultSet">
	SELECT *
	FROM CHAT_ONETOONE
	WHERE ID IN(#{id},#{friendId})
	AND   ID2 IN(#{id},#{friendId})
</select>
<insert id="insertChatOneToOne" parameterType="hashmap">
INSERT INTO CHAT_ONETOONE
		VALUES(SEQ_CO.NEXTVAL
			   ,#{id}
			   ,#{friendId})
        
</insert>

<insert id="insertChatmsg" parameterType="hashmap">
	INSERT INTO ONETOONE_LIST
		VALUES(SEQ_OL.NEXTVAR
				,#{co_no}
				,#{id}
				,#{msg}
				,SYSDATE)
</insert>

<select id="selectchatroom" parameterType="string" resultMap="chatResultSet">
	SELECT *
	FROM CHAT_ONETOONE
	WHERE ID = #{id}
			OR ID2 = #{id}
</select>

<select id="selectOnechatroom" parameterType="string" resultMap="chatResultSet">
	SELECT *
	FROM CHAT_ONETOONE
	WHERE CO_NO= #{co_no}
</select>
</mapper>

